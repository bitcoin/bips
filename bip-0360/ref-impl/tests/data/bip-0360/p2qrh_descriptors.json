{
    "version": 1,
    "test_vectors": [
        {
            "id": "p2qrh_single_key_commitment",
            "objective": "Tests P2QRH with single SECP256K1-SCHNORR public key only.  Expect error",
            "description": "At a minimum, there should be two different key types in a P2QRH output: one key that makes use of classical cryptography, and one that makes use of a PQC algorithm chosen within the wallet",
            "given": {
                "threshold": 2,
                "publicKey": "41203a81d53c97f5276865c1d29f5bfe742ff05ad1d63dfa0719cb78a0660074"
            },
            "intermediary": {
            },
            "expected": {
                "error": "P2QRH addresses expect at least one PQC public key of type ML-DSA-44 and/or SLH_DSA_128S"
            }
        },
        {
            "id": "p2qrh_mixed_single_key_commitment",
            "objective": "Tests P2QRH with single mix of SECP256K1-SCHNORR and ML-DSA-44 public keys",
            "given": {
                "threshold": 2,
                "publicKey": "41203a81d53c97f5276865c1d29f5bfe742ff05ad1d63dfa0719cb78a0660074",
                "publicKey": "6fe991c97f0094b2fb636ab4951878f239e2871c3cfdc2936230dac5dde8441d3ff41704025260c25b7e44416142778452694110793465d38ff66244a87aaacaf38103adde0dcf2f6056d48fcc43da9483ce6cfdd96ba2159b2f9653d24fe1f280c924db81830abe6d1070e5b32d2cf373c67dade4bd7c02bb6f5e76ff934316a774cc965fd9e921efbb81053260a07b84dd696d3eb012f9989cab684ce3c104bf926c7fd51a305a79ac2e825d6b5ea51618412b9076ca8f836342fb2412bcd525a9b435de5b0e1643dc2c49aa16a0ae710694657325bc86221ad6f9b5bb6195dee7d7f282c3046ae79f49c3d6339fe52b547ab06af76c12ae1812fa4d87f27700885e35ed91fac93388a4a5c0e37a65eb39f516122e264d716cc120500dc883eee64b22d944bc8061361629e27fc9105b28ff0723330793d6aa62dd6736d7cb157fe7e7545ed6be95d25d795eb24bff5e5b0445b18aa1081bbf99dc9eefb5e04984ca2d340278e2033e40d47824ff5e7c32343c3ffd7b209a49f88046fc52f3e145725aa5aff7cfa785a70accaaec63602f1e92f9a40c9aab89866b8ceab649dc58c4ae338297f8a9a419b70fe23229fd9bf264f403b5fee4e51651a7c5f21d82a3b5871436e85d84a2a036b117502d92e91cbef77ba75891eafcd8054dccd2b6c7201d1abc0dc2a5709a4897bafd88e673184c783ba5eed4f687df619280b532fd9e1b3c87028bc13bff6a71249825391e9b1790a5678ed021cd2820da1245dfda436d32394cbea6b5803b49e7234a538ddfbbd1a70051ee7357906660f71aac0728348230b66158ce6d6e061f2003cb3523fe5878b858c6c1aa94a4380a6cbe3012ec21a78a5fc94ab6697d64277fb5a3de6d7a9950aef094531303832dc77a334fabfcc4f9140fd8d420acf1f66e5a44e21c468dca0dee61913536d0bdf296618b73e43ecdc8a77b24644f0dfba4d009b552557d81a3203f9d434801925296763a2901360469547b3bc921217d1dbeb2f76e0dfaef9f91fc4a15baa57aca815b92d67615dee4c75b35df324246854f72a15109311ec2b5358446f48c1f925299bf701819c86be5aeafde4f616cd6c5db2762634a3387cb4b7eb317c569a50824fdce1bb858852550207144fc7ef6f3957c3417bcc6a7fb317441f87da106303a7da85b05dfacdcbc36910311669bb4f580d5282502c6797517521def3fd5d8bc04e5b55ba840a4cf193b8cc3e275bbd96632912ac5c4d26816c411ff4820401eceaffe1e32cfc6963565854b44a96585397cbb3aa3cd42ce8466748a8e769593fdd57a6f85dbdcf2705434302da89bd825196ae3ab3a2b3bd54864c41f0ba9dfccf0c2b508ef5e95b30e2706fc709f1261ca47fa236906c6d75e44ad388b8dc587ae98cd7442e279542e9bd776f20eefd24e701dab038a409f1ca25e7a8003519f3a7daf98e8ac2e9c11287a8bb4fa4219216387023418e9525c61e96440b48404fb8fbba19c469fe9e0291c2e4b61425cd69cfdd17826ce1652385316b461e6433a61185d13c548a16942403c75fceedb7823824b69986e6ce364784de01624429a149f9adb40c3274aa3ab2c13ac8769cc8f0a9e385c72410f08743a55f77066405af9fc9d036042788fc806eb1575c81cc3fbcc9f6a493ca54ee25eb202395f299bbc36f9e111edccc2e0020123b63b9ae53440bcdab7f7902f4acbee8b41f9b46551dc2185cfe3bffe4d2cd2e8abafbe01aed638cf9f1768466a74b055edb98002bc812fb6fb7d82abe53e4c94bc5e63d5836a931cec902044770a9406e4539145d5c8a5c699df243520c9c710de92582f180297ea0422e4196bf205"
            },
            "intermediary": {
                "concatenated": "xxxx",
                "commitment": "yyyy"
            },
            "expected": {
                "hash": "zzzz",
                "address": "bc1r8rt68aze8tek87cnz4ndnvfzk6tk93jv39n4lmpu5a4yw453rcpszsft3z"
            }
        },
        {
            "id": "p2qrh_mixed_multiple_key_commitment",
            "objective": "Tests P2QRH with multiple mix of SECP256K1_SCHNORR, ML_DSA_44 and SLH_DSA_128S public keys",
            "given": {
                "threshold": 3,
                "publicKey": "9d46fdd36eac78059fa4d146a654c1221ae878f54690a9646a600674222f33ca",
                "publicKey": "0b16be67d10c2d49adaadc17c2f566c67e95adfd529047bc6b65c3a5f47f738789e2d2768bc5bec3fcaba3efc717063a48957a0f562a49683ec2852696eda7f7b72c84665b7459409f58bad095dfc122912fce3d62306c7787b3a587745be34b579eeaabb574ce66b7139bff491c6e4c5eb65cccea321da3412a10eaca3528d4fac4a2147abb2104d830e29b32a8e6052fd3b9ac338fe51b9a6e0f893a8acdf93d55deebb7f4226d6cd4e02b0723081701121740d3ae7d11cbab82f23b14ddfd9032a434ad972c047aa3b577590605b7dc8b2c75fcbd490d504f2edffaae249a78fd554932d3bf3008b609171420216bd9d8c4607a60c953bc4512cf0c5cca73aa51de9185519768846f6c1f1b19a96748d44b80a8b8acd551a1902c967ab138f64ec6c9f662d5903aa0324d9b50fb52e262ae6676ed602ca622b705a2878e29db4e4134e81fa4cacbcf9ac8825a2d24e573acb6ad2b6323741630ae247c626bd82f1e460457f883c84f7708180ce66f4ea65ff90b7d604806d4fb5a3a27d6890d32f6266ffa6d06399e740c95d30b03777b9a90ec9e7e9aeb7492bd6a2c8574617a3bc55df2679ee50707876d095809c75b2b0cd526d0c2d2c232686f4f712606b87a648438b731823dc4cd7dc7ac6eeca2a19506f738152a828d9d953cc5a729a70b1c68643c39081e543488261e73fc5ddac2c5ec8303985eab64916b174f9c9cac01316795465968e68a78cea4accd7ba8530472f856930fb97cbd8130827cee5a5537abfaaa1d9fd88e8eefdf5dea3a92a502c53962d08a2ccda3b00608f02fc26165538a0ed90876d780986b4b551ce7fb68783e301735add0810bb16904bbe8c217ee8ca40aafab17f3ba535acdb87508140bdf01d550719a7d29a26a4b494956c84e2025d73741e4f5c30a17f47428d6af8c1145a1d67b4c76bddbd546c42004ccf3533e6630d8531891ffe7800a27f249b0af7cee08c6599546ea4c73721eabbda08bff659ce69bc9ab8224aa59b0566413e6cb6ff1f98dd1cb37d45c2e297cee9cc0d1fd28ad26171b54c67848cec24faaa5698427d53fa297f8f4ba741c794064cd195fb2a1602cba52f5232dc066405d6b5687b4948b8d0884c9be46a3660858c7684488c463d2c155c06282b7ddd93eff0ab52aa93998485a0225040499de4e7a0381defa63a1e8539929a2a2d433c84818de17db1528926d00fae6a836b48d44caab624ac8891dd9356e41680f551d81b4dac2f1d52d540c2b36c49909ac3d87a24c7eae849496af33c7bfcae36546cfd46936ec1bf90b6cd394d2a8fd0c236af4fd00789e05f738247cf35562f967c3f9b939adf613ab79cbfa0e06b07a09a55cf2e677a08d6c727f802bf0855be7153713d5633071d4ebb00ddda676c1578cfaf74a715935d094cfa9f7b97d2b5d440801cec996f1fde42c64cafbe348fa619521dcfd5b8d2cb3ca2c9d6cd276d0af1e2fa8fc2e5531868b6daad393eed8c7197d40779ff7df88fea2a769653b5f616af3f4a1eecfd1c5bac89f6c56d46a733826d0ffec129fc3cb1187aebc087c53bfe9a973cb145915ca140cb30a020609401a018fcb1c1b882c6cf95fd06eb9c70ac6de5ec98666dc10534eba017d36ea45d28e73d50202fa06f7e9cc29afd0e15548a15a841afbe793027e653b6993471280cbb3c7f4174053881242f0759c8f40ca2d7fdbabd0d180e99b02c08bfcd7201ed589e3afafefebac6365a5436b113a47f75587e03413752fd103fa0d868f0c4ec13812e6e3e13c5356a371b838d94a9aa8c858aa827c5a6e11302d9b35aa7faa11e0ddac2a2e697442ee9963623dce52989de3ccc20e81",
                "publicKey": "768a54113541212e258a8d24f912f61fcb3f40e6967570ba0ea35d8023e965d2"
            },
            "intermediary": {
                "concatenated": "xxxx",
                "commitment": "yyyy"
            },
            "expected": {
                "hash": "zzzz"
            }
        },
        {
            "id": "valid_p2qrh_address_generation",
            "objective": "Verify the correct generation of a P2QRH address from a given public key using the specified quantum-resistant hash function",
            "given": {
                "threshold": 2,
                "publicKey": "41203a81d53c97f5276865c1d29f5bfe742ff05ad1d63dfa0719cb78a0660074",
                "publicKey": "xxx"
            },
            "intermediary": {
            },
            "expected": {
                "error": "P2QRH addresses expect at least one PQC public key of type ML-DSA-44 and/or SLH_DSA_128S"
            }
        },
        {
            "id": "invalid_public_key_handling",
            "objective": "Ensure the system correctly identifies and rejects invalid or malformed public keys during address generation",
            "given": {
                "threshold": 2,
                "publicKey": "41203a81d53c97f5276865c1d29f5bfe742ff05ad1d63dfa0719cb78a0660074",
                "publicKey": "xxx"
            },
            "intermediary": {
            },
            "expected": {
                "error": "P2QRH addresses expect at least one PQC public key of type ML-DSA-44 and/or SLH_DSA_128S"
            }
        },
        {
            "id": "quantum_resistant_sig_verification",
            "objective": "Test the verification process of a transaction signed with a quantum-resistant signature algorithm",
            "given": {
                "threshold": 2,
                "publicKey": "41203a81d53c97f5276865c1d29f5bfe742ff05ad1d63dfa0719cb78a0660074",
                "publicKey": "6fe991c97f0094b2fb636ab4951878f239e2871c3cfdc2936230dac5dde8441d3ff41704025260c25b7e44416142778452694110793465d38ff66244a87aaacaf38103adde0dcf2f6056d48fcc43da9483ce6cfdd96ba2159b2f9653d24fe1f280c924db81830abe6d1070e5b32d2cf373c67dade4bd7c02bb6f5e76ff934316"
            },
            "intermediary": {
                "concatenated": "xxxx",
                "commitment": "yyyy"
            },
            "expected": {
                "hash": "zzzz"
            }
        },
        {
            "id": "p2qrh_unsupported_signature_algorithm_rejection",
            "objective": "Ensure that signatures using unsupported algorithms are correctly rejected",
            "given": {
                "threshold": 2,
                "publicKey": "41203a81d53c97f5276865c1d29f5bfe742ff05ad1d63dfa0719cb78a0660074",
                "publicKey": "invalid_quantum_key_type_12345"
            },
            "intermediary": {
            },
            "expected": {
                "error": "Unsupported quantum-resistant signature algorithm"
            }
        },
        {
            "id": "p2qrh_scriptpubkey_construction",
            "objective": "Validate the correct construction of the scriptPubKey for P2QRH addresses",
            "given": {
                "threshold": 2,
                "publicKey": "41203a81d53c97f5276865c1d29f5bfe742ff05ad1d63dfa0719cb78a0660074",
                "publicKey": "6fe991c97f0094b2fb636ab4951878f239e2871c3cfdc2936230dac5dde8441d3ff41704025260c25b7e44416142778452694110793465d38ff66244a87aaacaf38103adde0dcf2f6056d48fcc43da9483ce6cfdd96ba2159b2f9653d24fe1f280c924db81830abe6d1070e5b32d2cf373c67dade4bd7c02bb6f5e76ff934316"
            },
            "intermediary": {
                "concatenated": "xxxx",
                "commitment": "yyyy",
                "scriptPubKey": "OP_2 <commitment_hash> OP_EQUAL"
            },
            "expected": {
                "valid": true,
                "scriptPubKeyHex": "5220zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz87"
            }
        },
        {
            "id": "p2qrh_scriptsig_validation",
            "objective": "Ensure that the scriptSig correctly unlocks the P2QRH scriptPubKey",
            "given": {
                "threshold": 2,
                "publicKey": "41203a81d53c97f5276865c1d29f5bfe742ff05ad1d63dfa0719cb78a0660074",
                "publicKey": "6fe991c97f0094b2fb636ab4951878f239e2871c3cfdc2936230dac5dde8441d3ff41704025260c25b7e44416142778452694110793465d38ff66244a87aaacaf38103adde0dcf2f6056d48fcc43da9483ce6cfdd96ba2159b2f9653d24fe1f280c924db81830abe6d1070e5b32d2cf373c67dade4bd7c02bb6f5e76ff934316",
                "message": "0000000000000000000000000000000000000000000000000000000000000000"
            },
            "intermediary": {
                "scriptSig": "<quantum_sig> <classical_sig> <preimage>",
                "scriptPubKey": "OP_2 <commitment_hash> OP_EQUAL"
            },
            "expected": {
                "valid": true,
                "stack_result": true
            }
        },
        {
            "id": "p2qrh_multisig_address_handling",
            "objective": "Test the creation and validation of multisig P2QRH addresses",
            "given": {
                "threshold": 3,
                "publicKey": "41203a81d53c97f5276865c1d29f5bfe742ff05ad1d63dfa0719cb78a0660074",
                "publicKey": "6fe991c97f0094b2fb636ab4951878f239e2871c3cfdc2936230dac5dde8441d3ff41704025260c25b7e44416142778452694110793465d38ff66244a87aaacaf38103adde0dcf2f6056d48fcc43da9483ce6cfdd96ba2159b2f9653d24fe1f280c924db81830abe6d1070e5b32d2cf373c67dade4bd7c02bb6f5e76ff934316",
                "publicKey": "768a54113541212e258a8d24f912f61fcb3f40e6967570ba0ea35d8023e965d2"
            },
            "intermediary": {
                "concatenated": "xxxx",
                "commitment": "yyyy",
                "scriptPubKey": "OP_3 <commitment_hash> OP_EQUAL"
            },
            "expected": {
                "valid": true,
                "address": "qrh1qw508d6qejxtdg4y5r3zarvary0c5xw7kv8f3t4"
            }
        },
        {
            "id": "p2qrh_encoding_and_decoding_integrtiy",
            "objective": "Verify that encoding and decoding processes for P2QRH addresses are lossless and accurate",
            "given": {
                "threshold": 2,
                "publicKey": "41203a81d53c97f5276865c1d29f5bfe742ff05ad1d63dfa0719cb78a0660074",
                "publicKey": "6fe991c97f0094b2fb636ab4951878f239e2871c3cfdc2936230dac5dde8441d3ff41704025260c25b7e44416142778452694110793465d38ff66244a87aaacaf38103adde0dcf2f6056d48fcc43da9483ce6cfdd96ba2159b2f9653d24fe1f280c924db81830abe6d1070e5b32d2cf373c67dade4bd7c02bb6f5e76ff934316",
                "address": "qrh1qw508d6qejxtdg4y5r3zarvary0c5xw7kv8f3t4"
            },
            "intermediary": {
                "decoded_data": "xxxx",
                "reencoded_address": "qrh1qw508d6qejxtdg4y5r3zarvary0c5xw7kv8f3t4"
            },
            "expected": {
                "valid": true,
                "matches_original": true
            }
        },
        {
            "id": "p2qrh_checksum_validation",
            "objective": "confirm that the checksum mechanism detects errors in p2qrh addresses",
            "given": {
                "valid_address": "qrh1qw508d6qejxtdg4y5r3zarvary0c5xw7kv8f3t4",
                "corrupted_addresses": [
                    "qrh1qw508d6qejxtdg4y5r3zarvary0c5xw7kv8f3t5",
                    "qrh1qw508d6qejxtdg4y5r3zarvary0c5xw7kv8f3t3",
                    "qrh2qw508d6qejxtdg4y5r3zarvary0c5xw7kv8f3t4"
                ]
            },
            "intermediary": {
                "checksum_calculations": ["xxxx", "yyyy", "zzzz"]
            },
            "expected": {
                "valid_address_check": true,
                "corrupted_addresses_check": [false, false, false],
                "error": "Invalid checksum"
            }
        },
        {
            "id": "p2qrh_utxo_serialization_compatibility",
            "objective": "ensure (de)serializer functionality supports p2qrh utxos",
            "given": {
                "utxo": {
                    "txid": "0000000000000000000000000000000000000000000000000000000000000000",
                    "vout": 0,
                    "amount": 100000000,
                    "height": 1000000,
                    "scriptPubKey": "5220zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz87"
                }
            },
            "intermediary": {
                "serialized": "xxxx",
                "deserialized": {
                    "txid": "0000000000000000000000000000000000000000000000000000000000000000",
                    "vout": 0,
                    "amount": 100000000,
                    "height": 1000000,
                    "scriptPubKey": "5220zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz87"
                }
            },
            "expected": {
                "valid": true,
                "matches_original": true
            }
        }
    ]
}
